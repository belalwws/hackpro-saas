# ğŸ”§ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ‚Ù†ÙŠ - Ù…Ù†ØµØ© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡Ø§ÙƒØ§Ø«ÙˆÙ†Ø§Øª

**ØªØ§Ø±ÙŠØ® Ø§Ù„ÙØ­Øµ:** 2025-10-21  
**Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… ØªÙ… Ø§Ù„ÙØ­Øµ Ø§Ù„Ø´Ø§Ù…Ù„

---

## ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ

### âœ… Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø³Ù„ÙŠÙ…Ø©
- Next.js 15 Ù…Ø¹ App Router
- TypeScript Ù„Ù„Ù€ type safety
- Prisma ORM Ù…Ø¹ PostgreSQL
- Authentication system Ù…Ø­ÙƒÙ…
- File upload system ÙŠØ¹Ù…Ù„
- Email system Ù…ÙƒØªÙ…Ù„

### âœ… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- **Provider:** Neon PostgreSQL
- **Location:** EU Central (ep-icy-cloud-agh12oz7)
- **Status:** âœ… Ù…ØªØµÙ„Ø© ÙˆØªØ¹Ù…Ù„
- **Data:** âœ… ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª production Ø­Ù‚ÙŠÙ‚ÙŠØ©
- **Schema:** Ù…Ø­Ø¯Ø« ÙˆÙ…ØªØ²Ø§Ù…Ù†

### âœ… Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ©
- **Platform:** Digital Ocean App Platform
- **URL:** https://clownfish-app-px9sc.ondigitalocean.app
- **Status:** âœ… ÙŠØ¹Ù…Ù„
- **Auto-Deploy:** Ù…ÙØ¹Ù‘Ù„ Ù…Ù† GitHub

---

## ğŸ—„ï¸ ØªØ­Ù„ÙŠÙ„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

### Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (27 Ø¬Ø¯ÙˆÙ„)

#### Core Tables
1. **users** - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±)
2. **hackathons** - Ø§Ù„Ù‡Ø§ÙƒØ§Ø«ÙˆÙ†Ø§Øª
3. **teams** - Ø§Ù„ÙØ±Ù‚
4. **participants** - Ø§Ù„Ù…Ø´Ø§Ø±ÙƒÙˆÙ†
5. **judges** - Ø§Ù„Ù…Ø­ÙƒÙ…ÙˆÙ†
6. **experts** - Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡
7. **supervisors** - Ø§Ù„Ù…Ø´Ø±ÙÙˆÙ†
8. **admins** - Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡

#### Evaluation System
9. **scores** - Ø§Ù„Ø¯Ø±Ø¬Ø§Øª
10. **evaluation_criteria** - Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
11. **results_snapshots** - Ù„Ù‚Ø·Ø§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬

#### Forms & Applications
12. **forms** - Ø§Ù„Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø¹Ø§Ù…Ø©
13. **form_responses** - Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
14. **hackathon_forms** - Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
15. **judge_applications** - Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø­ÙƒÙ…ÙŠÙ†
16. **judge_invitations** - Ø¯Ø¹ÙˆØ§Øª Ø§Ù„Ù…Ø­ÙƒÙ…ÙŠÙ†
17. **expert_applications** - Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡
18. **expert_invitations** - Ø¯Ø¹ÙˆØ§Øª Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡
19. **supervisor_invitations** - Ø¯Ø¹ÙˆØ§Øª Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†

#### Email & Templates
20. **email_templates** - Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª
21. **email_attachments** - Ù…Ø±ÙÙ‚Ø§Øª Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª

#### Landing Pages & Feedback
22. **hackathon_landing_pages** - ØµÙØ­Ø§Øª Ø§Ù„Ù‡Ø¨ÙˆØ·
23. **hackathon_form_designs** - ØªØµØ§Ù…ÙŠÙ… Ø§Ù„Ù†Ù…Ø§Ø°Ø¬
24. **hackathon_feedback_forms** - Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø©
25. **hackathon_feedbacks** - Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø©

#### Misc
26. **upload_tokens** - Ø±Ù…ÙˆØ² Ø§Ù„Ø±ÙØ¹
27. **global_settings** - Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©

---

## ğŸ” Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª

### Middleware Protection
```typescript
// middleware.ts
const protectedRoutes = [
  { prefix: "/api/admin/email-templates", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin/hackathons", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin/experts", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin/expert-invitations", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin/expert-applications", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin/judges", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin/judge-invitations", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin/judge-applications", roles: ["admin", "supervisor"] },
  { prefix: "/api/admin", roles: ["admin"] },
  // ... more routes
]
```

### Role Hierarchy
```
admin > supervisor > judge/expert > participant
```

---

## ğŸ“ API Routes Structure

### Authentication (`/api/auth`)
- `POST /api/auth/login` - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
- `POST /api/auth/register` - Ø§Ù„ØªØ³Ø¬ÙŠÙ„
- `GET /api/auth/verify` - Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø©
- `POST /api/auth/logout` - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬

### Admin (`/api/admin`)
- `/api/admin/dashboard` - Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Dashboard
- `/api/admin/hackathons` - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‡Ø§ÙƒØ§Ø«ÙˆÙ†Ø§Øª
- `/api/admin/users` - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- `/api/admin/experts` - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø®Ø¨Ø±Ø§Ø¡
- `/api/admin/judges` - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­ÙƒÙ…ÙŠÙ†
- `/api/admin/email-templates` - Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨

### Supervisor (`/api/supervisor`)
- `/api/supervisor/hackathons/[id]/teams` - Ø§Ù„ÙØ±Ù‚
- `/api/supervisor/upload-attachment` - Ø±ÙØ¹ Ø§Ù„Ù…Ø±ÙÙ‚Ø§Øª
- `/api/supervisor/send-email` - Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„Ø§Øª

### Judge (`/api/judge`)
- `/api/judge/dashboard` - Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø­ÙƒÙ…
- `/api/submit-score` - Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª

### Participant (`/api/participant`)
- `/api/participant/dashboard` - Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ
- `/api/participant/upload-idea` - Ø±ÙØ¹ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…ÙŠ

### Expert (`/api/expert`)
- `/api/expert/apply` - ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø®Ø¨ÙŠØ±
- `/api/expert/dashboard` - Ù„ÙˆØ­Ø© Ø§Ù„Ø®Ø¨ÙŠØ±

---

## ğŸ¨ Frontend Components

### UI Components (shadcn/ui)
- Button, Input, Select, Dialog, Toast
- Table, Card, Tabs, Accordion
- Form components with validation
- Loading states and skeletons

### Custom Components
- `admin-dashboard.tsx` - Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯ÙŠØ±
- `landing-page.tsx` - ØµÙØ­Ø© Ø§Ù„Ù‡Ø¨ÙˆØ·
- `login-form.tsx` - Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
- `team-input-screen.tsx` - Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±ÙŠÙ‚
- `results-screen.tsx` - Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
- `Certificate.tsx` - ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª
- `NotificationSystem.tsx` - Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª

### 3D Components
- `components/3d/` - Ù…ÙƒÙˆÙ†Ø§Øª Three.js
- `components/visuals/` - Ù…ÙƒÙˆÙ†Ø§Øª Ø¨ØµØ±ÙŠØ©

---

## ğŸ“§ Email System

### Configuration
```typescript
// lib/mailer.ts
const transporter = nodemailer.createTransport({
  service: 'gmail',
  auth: {
    user: process.env.GMAIL_USER,
    pass: process.env.GMAIL_PASS
  }
})
```

### Features
- âœ… Template-based emails
- âœ… Dynamic variables
- âœ… File attachments (Cloudinary)
- âœ… Rate limiting (1 email/2s)
- âœ… Batch sending
- âœ… Error handling

### Templates
- Ø¯Ø¹ÙˆØ© Ù…Ø­ÙƒÙ…
- Ø¯Ø¹ÙˆØ© Ø®Ø¨ÙŠØ±
- ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙØ±ÙŠÙ‚
- Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù‚Ø¨ÙˆÙ„/Ø§Ù„Ø±ÙØ¶
- Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª

---

## â˜ï¸ Cloudinary Integration

### Configuration
```typescript
// lib/cloudinary.ts
cloudinary.config({
  cloud_name: process.env.CLOUDINARY_CLOUD_NAME,
  api_key: process.env.CLOUDINARY_API_KEY,
  api_secret: process.env.CLOUDINARY_API_SECRET,
})
```

### Upload Functions
```typescript
// Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±
uploadToCloudinary(buffer, folder, filename)

// Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª (PDF, etc)
uploadRawToCloudinary(buffer, folder, filename)
```

### Folders Structure
```
cloudinary://djva3nfy5/
â”œâ”€â”€ hackathon/
â”‚   â”œâ”€â”€ experts/
â”‚   â”‚   â”œâ”€â”€ profiles/
â”‚   â”‚   â””â”€â”€ cv/
â”‚   â”œâ”€â”€ presentations/
â”‚   â””â”€â”€ certificates/
â””â”€â”€ email-attachments/
    â””â”€â”€ documents/
```

---

## ğŸ”’ Security Measures

### Authentication
- JWT tokens (7 days expiry)
- Secure httpOnly cookies
- Password hashing (bcryptjs, 12 rounds)
- Token verification on every request

### Authorization
- Role-based access control (RBAC)
- Middleware protection
- API-level permission checks
- Route guards

### Rate Limiting
```typescript
// lib/rate-limit.ts
rateLimit(request, limit, windowMs)
// Example: 5 login attempts per 5 minutes
```

### Data Validation
- Zod schemas for input validation
- Type-safe with TypeScript
- Prisma schema validation

---

## ğŸ“¦ Dependencies

### Core
- next: ^15.5.2
- react: ^19.1.1
- typescript: ^5

### Database & ORM
- @prisma/client: latest
- prisma: latest

### UI & Styling
- tailwindcss: ^3.4.17
- @radix-ui/*: latest (shadcn/ui)
- framer-motion: latest
- lucide-react: ^0.454.0

### Forms & Validation
- react-hook-form: latest
- zod: ^3.24.1
- @hookform/resolvers: ^3.9.1

### File Upload & Email
- cloudinary: ^1.41.0
- nodemailer: ^6.10.1

### Authentication
- jose: latest (JWT)
- bcryptjs: latest

### 3D Graphics
- three: latest
- @react-three/fiber: latest
- @react-three/drei: latest

### Utilities
- date-fns: 4.1.0
- xlsx: ^0.18.5 (Excel export)
- canvas: ^3.2.0 (Certificate generation)

---

## ğŸš€ Performance Optimizations

### Build Optimizations
```javascript
// next.config.js
{
  output: 'standalone',
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production' ? {
      exclude: ['error', 'warn']
    } : false
  },
  experimental: {
    optimizePackageImports: ['lucide-react', '@radix-ui/react-icons']
  }
}
```

### Database
- Connection pooling (10 connections)
- Indexed foreign keys
- Optimized queries

### Caching
- Static file caching
- API response caching (where applicable)

---

## ğŸ› Known Issues & Solutions

### âœ… Fixed Issues
1. **Cloudinary attachments 401 error**
   - Solution: Added `access_mode: 'public'` to uploads

2. **Supervisor can't access admin APIs**
   - Solution: Updated middleware routes

3. **Email attachments not sending**
   - Solution: Made Cloudinary files public

### âš ï¸ Potential Issues
1. **Gmail quota limits**
   - Solution: Implement rate limiting (already done)
   - Consider switching to dedicated email service

2. **Cloudinary storage limits**
   - Monitor usage
   - Implement cleanup for old files

---

## ğŸ“ Development Guidelines

### Code Style
- TypeScript strict mode
- ESLint + Prettier (disabled for deployment)
- Consistent naming conventions
- Arabic comments for business logic

### Git Workflow
- Branch: `Ø§Ø®ÙŠØ±` (main development)
- Commit messages in Arabic/English
- Auto-deploy to Digital Ocean

### Testing
- Manual testing via `/test-api.html`
- Console logging for debugging
- Error boundaries for React components

---

## ğŸ”„ Deployment Process

### Current Setup
1. Push to GitHub (branch: Ø§Ø®ÙŠØ±)
2. Digital Ocean auto-deploys
3. Build command: `npm install && prisma generate && npm run build`
4. Start command: `npm start`

### Environment Variables
All set in Digital Ocean dashboard:
- DATABASE_URL (from Neon)
- JWT_SECRET
- NEXTAUTH_URL
- NEXTAUTH_SECRET
- GMAIL_USER
- GMAIL_PASS
- CLOUDINARY_*

---

## ğŸ“Š Database Statistics

### Current Data (as of last check)
- Users: Multiple (various roles)
- Hackathons: 3 (all open)
- Teams: Multiple
- Expert Invitations: 5
- Expert Applications: 3
- Judge Invitations: 5
- Judge Applications: 5
- Judges (approved): 1

---

## âš ï¸ CRITICAL WARNINGS

### ğŸ”´ Database
- **NEVER** run destructive migrations without backup
- **ALWAYS** test migrations locally first
- **USE** `scripts/backup-database.js` before major changes

### ğŸ”´ Production
- **NEVER** delete files from Cloudinary without verification
- **ALWAYS** test email templates before mass sending
- **CHECK** logs after deployment

---

## ğŸ“ Support & Maintenance

### Backup Strategy
```bash
# Daily backup (recommended)
node scripts/backup-database.js

# Stored in: data/backups/
```

### Monitoring
- Check Digital Ocean logs regularly
- Monitor Cloudinary usage
- Monitor Gmail quota
- Check Neon database metrics

### Troubleshooting
1. Check logs: Digital Ocean â†’ Apps â†’ Runtime Logs
2. Test APIs: `/test-api.html`
3. Check database: `npm run db:test`
4. Verify environment variables

---

**Ø§Ù„Ø®Ù„Ø§ØµØ©:** Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙÙŠ Ø­Ø§Ù„Ø© Ù…Ù…ØªØ§Ø²Ø©ØŒ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ù…Ø­ÙƒÙ…Ø©ØŒ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª production Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙˆÙŠØ¬Ø¨ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§ Ø¨Ø­Ø°Ø± Ø´Ø¯ÙŠØ¯.

